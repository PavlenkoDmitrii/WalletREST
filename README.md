# Wallet RESTful API

## Описание проекта

Приложение, которое по REST принимает запросы для управления кошельками.  

---
### Основные операции:
### Пополнение или снятие средств

`POST /api/v1/wallet`

```json
{
  "walletId": "UUID",
  "operation": "DEPOSIT" or "WITHDRAW",
  "amount": 1000
}
```

После выполнения запроса происходит логика по изменению счета в базе данных.

---

### Получение баланса кошелька

`GET /api/v1/wallets/{WALLET_UUID}`

Возвращает текущий баланс указанного кошелька.

---

## Миграции базы данных

- Используются миграции с помощью **Liquibase**.
- Основной файл миграций:  
  `src/main/resources/db/changelog/db.changelog-master.yaml` — подключение всех changelog-файлов.
- Файлы создания таблицы и заполнение таблицы тестовыми данными размещены в директории:  
  `src/main/resources/db/changelog/data`.

---

## Обеспечение безопасности и конкурентной работы

- Для предотвращения проблем при одновременных операциях используется **оптимистичная блокировка** с помощью аннотации `@Version`.
- Обработка ошибок осуществляется через **Global Exception Handler**, который обеспечивает стандартизированные ответы при ошибках:
  - Когда кошелек не существует;
  - Не валидный JSON;
  - Недостаточно средств.

---

## Развертывание и запуск

- Вся система запускается в **Docker-контейнерах**.
- Для поднятия системы используется команда:

```
docker-compose up
```

- Настройка параметров возможна как на стороне приложения, так и базы данных без пересборки контейнеров.

---

## Дополнительная информация

- В Dockerfile настроено автоматическое выполнение команд:

```
mvn clean package
```

- Эндпоинты покрыты тестами.

---

## Требования к окружению

- Java 17+
- Spring Boot 3.x
- Maven для сборки

---
